╔══════════════════════════════════════════════════════════════════════╗
║                                                                      ║
║        📱 GUIA RÁPIDO: Configuração Meta WhatsApp                   ║
║                                                                      ║
╚══════════════════════════════════════════════════════════════════════╝


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ O QUE JÁ ESTÁ PRONTO
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ Webhook URL verificada pelo Meta
✅ Token aceito (atenmed_webhook_2025)
✅ Servidor AWS funcionando
✅ HTTPS configurado


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 O QUE FALTA FAZER (SIMPLES!)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Apenas 1 coisa: Habilitar o campo "messages" no Meta


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 PASSO A PASSO
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. Acesse: https://developers.facebook.com/apps/

2. Selecione seu App WhatsApp

3. Vá em: WhatsApp → Configuração → Webhook

4. Role a página até ver "Webhook fields"

5. Marque APENAS este campo:
   
   ☑️ messages


6. Clique em "Subscribe" ou "Salvar"


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
❓ E O "message_status"?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

NÃO SE PREOCUPE! 

Esse campo:
• Pode não existir na sua versão da API
• NÃO é obrigatório
• Serve apenas para status de mensagens ENVIADAS
• Você NÃO precisa dele para RECEBER mensagens


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ O QUE VOCÊ PRECISA (APENAS ISSO!)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Campo obrigatório:
   ☑️ messages  ← SÓ ISSO!


Campos opcionais (se existirem, pode marcar também):
   ☐ message_echoes
   ☐ message_reads
   ☐ messaging_postbacks


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🧪 COMO TESTAR DEPOIS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. Executar teste simulado:
   
   npm run test-webhook-msg


2. Enviar mensagem REAL:
   
   Do seu WhatsApp → Número do Business


3. Ver se chegou nos logs:
   
   ssh -i "C:\Users\Ian_1\Documents\AtenMed\site-atenmed.pem" ubuntu@3.129.206.231
   tail -f /var/www/atenmed/logs/combined.log


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 O QUE VOCÊ VERÁ NOS LOGS (quando funcionar)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📬 Webhook recebido: 1 entradas
📨 Processando mensagem de 5511999999999
✅ Mensagem processada com sucesso


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔍 ONDE ENCONTRAR "Webhook fields" NO META
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Opção 1:
   Dashboard → WhatsApp → Configuration → Webhooks
   ↓
   Role até "Webhook fields"


Opção 2:
   Menu lateral esquerdo → WhatsApp → Configuração
   ↓
   Clique na aba "Webhook"
   ↓
   Role para baixo


Opção 3:
   Procure por "Subscribe to webhook fields"


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💡 DICA: Como Saber se Funcionou
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Depois de marcar "messages" e salvar:

✅ Campo deve mostrar checkmark verde
✅ Status deve ser "Subscribed" ou "Inscrito"
✅ Pode aparecer o ícone de um sino 🔔


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🚨 PROBLEMAS COMUNS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

❌ "Não vejo 'Webhook fields'"
   → Role mais para baixo na página
   → Tente clicar na aba "Configuration"
   → Procure "Subscribe to fields"


❌ "Não consigo marcar 'messages'"
   → Verifique se o webhook foi verificado primeiro
   → Recarregue a página
   → Tente em outro navegador


❌ "Marquei mas não recebo mensagens"
   → Espere 1-2 minutos para propagar
   → Execute: npm run test-webhook-msg
   → Verifique os logs do servidor


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📚 DOCUMENTAÇÃO COMPLETA
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Para mais detalhes, leia:

⭐ CONFIGURACAO-META-WHATSAPP.md  ← Guia completo e detalhado
   PROXIMO-PASSO-WHATSAPP.md      ← Próximos passos
   COMANDOS-WHATSAPP-RAPIDOS.txt  ← Comandos úteis


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ CHECKLIST
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[✅] Webhook verificado pelo Meta
[ ] Campo "messages" habilitado      ← VOCÊ ESTÁ AQUI
[ ] Teste simulado (npm run test-webhook-msg)
[ ] Mensagem real enviada
[ ] Mensagem recebida nos logs


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 RESUMO
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Você precisa fazer APENAS:

1. Ir no Meta Developer Console
2. WhatsApp → Configuração → Webhook
3. Marcar: ☑️ messages
4. Salvar

Pronto! É só isso! 🎉


╔══════════════════════════════════════════════════════════════════════╗
║                                                                      ║
║   Depois disso, execute: npm run test-webhook-msg                   ║
║                                                                      ║
╚══════════════════════════════════════════════════════════════════════╝

